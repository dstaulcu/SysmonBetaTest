<Sysmon schemaversion="4.3">

	<DnsLookup>False</DnsLookup>

	<EventFiltering>

			<!--SYSMON EVENT ID 1 : Process Create [ProcessCreate]-->
				<!--DATA: RuleName, UtcTime, ProcessGuid, ProcessId, Image, FileVersion, Description, Product, Company, OriginalFileName, CommandLine, CurrentDirectory, User, LogonGuid, LogonId, TerminalSessionId, IntegrityLevel, Hashes, ParentProcessGuid, ParentProcessId, ParentImage, ParentCommandLine-->

			<RuleGroup name="ProcessCreate_RG_001" groupRelation="or">
				<ProcessCreate onmatch="include">
				</ProcessCreate>
			</RuleGroup>

			<!--SYSMON EVENT ID 2 : File creation time changed [FileCreateTime]-->
				<!--DATA: RuleName, UtcTime, ProcessGuid, ProcessId, Image, TargetFilename, CreationUtcTime, PreviousCreationUtcTime-->

			<RuleGroup name="FileCreateTime_RG_001" groupRelation="or">
				<FileCreateTime onmatch="include">
				</FileCreateTime>
			</RuleGroup>

			<!--SYSMON EVENT ID 3 : Network connection detected [NetworkConnect]-->
				<!--DATA: RuleName, UtcTime, ProcessGuid, ProcessId, Image, User, Protocol, Initiated, SourceIsIpv6, SourceIp, SourceHostname, SourcePort, SourcePortName, DestinationIsIpv6, DestinationIp, DestinationHostname, DestinationPort, DestinationPortName-->

			<RuleGroup name="NetworkConnect_RG_001" groupRelation="or">
				<NetworkConnect onmatch="exclude">
				</NetworkConnect>
			</RuleGroup>

			<!--SYSMON EVENT ID 5 : Process terminated [ProcessTerminate]-->
				<!--DATA: RuleName, UtcTime, ProcessGuid, ProcessId, Image-->

			<RuleGroup name="ProcessTerminate_RG_001" groupRelation="or">
				<ProcessTerminate onmatch="include">
				</ProcessTerminate>
			</RuleGroup>

			<!--SYSMON EVENT ID 6 : Driver loaded [DriverLoad]-->
				<!--DATA: RuleName, UtcTime, ImageLoaded, Hashes, Signed, Signature, SignatureStatus-->

			<RuleGroup name="DriverLoad_RG_001" groupRelation="or">
				<DriverLoad onmatch="include">
				</DriverLoad>
			</RuleGroup>

			<!--SYSMON EVENT ID 7 : Image loaded [ImageLoad]-->
				<!--DATA: RuleName, UtcTime, ProcessGuid, ProcessId, Image, ImageLoaded, FileVersion, Description, Product, Company, OriginalFileName, Hashes, Signed, Signature, SignatureStatus-->

			<RuleGroup name="ImageLoad_RG_001" groupRelation="or">
				<ImageLoad onmatch="include">
				</ImageLoad>
			</RuleGroup>

			<!--SYSMON EVENT ID 8 : CreateRemoteThread detected [CreateRemoteThread]-->
				<!--DATA: RuleName, UtcTime, SourceProcessGuid, SourceProcessId, SourceImage, TargetProcessGuid, TargetProcessId, TargetImage, NewThreadId, StartAddress, StartModule, StartFunction-->

			<RuleGroup name="CreateRemoteThread_RG_001" groupRelation="or">
				<CreateRemoteThread onmatch="include">
				</CreateRemoteThread>
			</RuleGroup>

			<!--SYSMON EVENT ID 9 : RawAccessRead detected [RawAccessRead]-->
				<!--DATA: RuleName, UtcTime, ProcessGuid, ProcessId, Image, Device-->

			<RuleGroup name="RawAccessRead_RG_001" groupRelation="or">
				<RawAccessRead onmatch="include">
				</RawAccessRead>
			</RuleGroup>

			<!--SYSMON EVENT ID 10 : Process accessed [ProcessAccess]-->
				<!--DATA: RuleName, UtcTime, SourceProcessGUID, SourceProcessId, SourceThreadId, SourceImage, TargetProcessGUID, TargetProcessId, TargetImage, GrantedAccess, CallTrace-->

			<RuleGroup name="ProcessAccess_RG_001" groupRelation="or">
				<ProcessAccess onmatch="include">
				</ProcessAccess>
			</RuleGroup>

			<!--SYSMON EVENT ID 11 : File created [FileCreate]-->
				<!--DATA: RuleName, UtcTime, ProcessGuid, ProcessId, Image, TargetFilename, CreationUtcTime-->

			<RuleGroup name="FileCreate_RG_001" groupRelation="or">
				<FileCreate onmatch="include">
				</FileCreate>	
			</RuleGroup>				
	


			<!--SYSMON EVENT ID 12 : Registry object added or deleted [RegistryEvent]-->
				<!--DATA: RuleName, EventType, UtcTime, ProcessGuid, ProcessId, Image, TargetObject-->
			<!--SYSMON EVENT ID 13 : Registry value set [RegistryEvent]-->
				<!--DATA: RuleName, EventType, UtcTime, ProcessGuid, ProcessId, Image, TargetObject, Details-->
			<!--SYSMON EVENT ID 14 : Registry object renamed [RegistryEvent]-->
				<!--DATA: RuleName, EventType, UtcTime, ProcessGuid, ProcessId, Image, TargetObject, NewName-->
				
			<RuleGroup name="RegistryEvent_RG_001" groupRelation="or">
				<RegistryEvent onmatch="include">
				</RegistryEvent>
			</RuleGroup>


			<!--SYSMON EVENT ID 15 : File stream created [FileCreateStreamHash]-->
				<!--DATA: RuleName, UtcTime, ProcessGuid, ProcessId, Image, TargetFilename, CreationUtcTime, Hash-->

			<RuleGroup name="FileCreateStreamHash_RG_001" groupRelation="or">
				<FileCreateStreamHash onmatch="include">
				</FileCreateStreamHash>
			</RuleGroup>

			<!--SYSMON EVENT ID 17 : Pipe Created [PipeEvent]-->
				<!--DATA: RuleName, EventType, UtcTime, ProcessGuid, ProcessId, PipeName, Image-->
			<!--SYSMON EVENT ID 18 : Pipe Connected [PipeEvent]-->
				<!--DATA: RuleName, EventType, UtcTime, ProcessGuid, ProcessId, PipeName, Image-->

			<RuleGroup name="PipeEvent_RG_001" groupRelation="or">
				<PipeEvent onmatch="include">
				</PipeEvent>
			</RuleGroup>


			<!--SYSMON EVENT ID 19 : WmiEventFilter activity detected [WmiEvent]-->
				<!--DATA: RuleName, EventType, UtcTime, Operation, User, EventNamespace, Name, Query-->
			<!--SYSMON EVENT ID 20 : WmiEventConsumer activity detected [WmiEvent]-->
				<!--DATA: RuleName, EventType, UtcTime, Operation, User, Name, Type, Destination-->
			<!--SYSMON EVENT ID 21 : WmiEventConsumerToFilter activity detected [WmiEvent]-->
				<!--DATA: RuleName, EventType, UtcTime, Operation, User, Consumer, Filter-->

			<RuleGroup name="WmiEvent_RG_001" groupRelation="or">
				<WmiEvent onmatch="include">
				</WmiEvent>
			</RuleGroup>


			<!--SYSMON EVENT ID 22 : Dns query [DnsQuery]-->
				<!--DATA: RuleName, UtcTime, ProcessGuid, ProcessId, QueryName, QueryStatus, QueryResults, Image-->				

			<RuleGroup name="DnsQuery_RG_001" groupRelation="or">
				<DnsQuery onmatch="exclude">
				</DnsQuery>				
			</RuleGroup>

		

	</EventFiltering>
</Sysmon>

